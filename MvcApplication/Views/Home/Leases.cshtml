@using MvcApplication.Models
@using System.Linq
@{
    ViewBag.Title = "Leases";
}

<h2>Leases For @ViewBag.Name</h2>

<button class="btn btn-primary btn-sm" style="margin-right: 10px;" data-bind="click: add">New</button>
<button class="btn btn-success btn-sm" onclick="window.location = '@ViewBag.FromUrl'">Back</button>

<table id="leases" class="table table-striped table-hover">
    <thead>
        <tr>
	        <th>Building</th>
			<th>Unit</th>
			<th>Start Date</th>
            <th>End Date</th>
            <th>Is Month To Month</th>
            <th>Payment Due Day</th>
        </tr>
    </thead>
    <tbody data-bind="foreach: items">
	    <tr class="form-group">
		    <pre data-bind="text: ko.toJSON($data, null, 2)"></pre>
			@{
				
			}
		    <td><input type="text" class="form-control input-sm disabled" data-bind="value: buildingId"></td>
			<td><input type="text" class="form-control input-sm disabled" data-bind="value: unitId"></td>
		    <td><input type="text" class="form-control input-sm datepicker" data-bind="datepicker: startDate"></td>
		    <td><input type="text" class="form-control input-sm datepicker" data-bind="datepicker: endDate"></td>
		    <td><input type="checkbox" class="checkbox" data-bind="checked: isMonthToMonth" style="width: 40px; margin-left: 50px" /></td>
		    <td><input type="text" class="form-control input-sm" data-bind="value: paymentDueDay"></td>
		    <td>
			    <a data-bind="attr: { href: '@Url.Action("LeaseDetails", "Home")/' + id() + '?companyid=' + companyId() }" class="btn btn-info btn-sm">Details</a>
               
		    </td>
		    <td>@Html.Partial("_DeleteButton")</td>
	    </tr>
    </tbody>
</table>

@section Scripts {
    <script type="text/javascript">
        $(function() {
            var url = "@Url.RouteUrl("leases", new {httproute = "", companyid = ViewBag.Id})";
            var defaults = {};
            @if (!string.IsNullOrEmpty(ViewBag.BuildingId))
            {
                @:url += "?buildingid=@ViewBag.BuildingId";
                @:defaults.buildingId = "@ViewBag.BuildingId";
            }
            @if (!string.IsNullOrEmpty(ViewBag.UnitId))
            {
                @:url += "&unitid=@ViewBag.UnitId";
                @:defaults.unitId = "@ViewBag.UnitId";
            }
            @if (!string.IsNullOrEmpty(ViewBag.TenantId))
            {
                @:url += "&tenantid=@ViewBag.TenantId";
                @:defaults.tenantId = "@ViewBag.TenantId";
            }
            var viewModel = new propertyManager.ViewModel(url, defaults);
            viewModel.get(function() {
                ko.applyBindings(viewModel);
            });
        });
    </script>
}